#version 300 es
precision highp float;precision highp int;uniform highp sampler2D lightPlaneMap;flat in highp float linemapV;in highp vec2 localUv;flat in highp vec4 colourAndDecayRate;layout(location=0)out highp vec4 outCol;vec3 _;void main(){ivec2 a=textureSize(lightPlaneMap,0);int b=a.x;highp float c=float(b);highp float d=.5*uintBitsToFloat(2130706432u-floatBitsToUint(c));highp float e=abs(localUv.x);highp float f=abs(localUv.y);highp float g=min(e,f)/max(e,f);highp float h=g*g;highp float i=(((((.013506162*h)+(-.046842404))*h)+(-.84141517))*g)+g;highp float j;if(f>e){j=.25-i;}else{j=i;}highp float k;if(localUv.x<0.){k=.5-j;}else{k=j;}highp float l=((uintBitsToFloat(floatBitsToUint(k)^(floatBitsToUint(localUv.y)&2147483648u))+1.)*c)-.5;int m=int(linemapV*float(a.y));int n=int(l);int o=b-1;highp vec4 p=texelFetch(lightPlaneMap,ivec2(n&o,m),0);highp vec4 q=texelFetch(lightPlaneMap,ivec2((n+1)&o,m),0);highp vec2 r=(p.xy*2.)-vec2(1.);highp vec3 s=_;s.x=r.x;highp vec3 t=s;t.y=r.y;highp vec2 u=(q.xy*2.)-vec2(1.);highp vec3 v=_;v.x=u.x;highp vec3 w=v;w.y=u.y;highp float x=p.z;highp float y=q.z;outCol=vec4((colourAndDecayRate.xyz*pow(length(localUv)+1.,-colourAndDecayRate.w))*mix(1.-smoothstep(x-d,x+d,dot(localUv,t.xy)),1.-smoothstep(y-d,y+d,dot(localUv,w.xy)),smoothstep(0.,1.,fract(l))),0.);}