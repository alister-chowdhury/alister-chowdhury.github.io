#version 300 es
precision highp float;precision highp int;uniform highp sampler2D v1LinesBvh;uniform highp usampler2D lightingData;in highp vec2 uv;layout(location=0)out highp vec4 outPlane;vec4 _;vec2 a;ivec2 b;vec2 c;ivec2 d;void main(){highp vec2 e=uintBitsToFloat(texelFetch(lightingData,ivec2(int(gl_FragCoord.y),0),0).xy);highp float f=uv.x*6.2831855;highp vec2 g=vec2(cos(f),sin(f));highp vec2 h=vec2(1.)/g;highp vec2 i;highp vec4 j;uint k;highp vec2 l;ivec2 m;m=b;l=a;k=4294967295u;j=_;i=g*1.;int n[16];highp vec2 o;highp vec4 p;highp float q;uint r;bool s;int t;highp vec2 u;ivec2 v;int w;bool x=false;int y=0;highp float z=1.;int A=0;for(;!x;A=w,m=v,l=u,k=r,z=q,j=p,i=o,y=t,x=s){highp vec4 B=texelFetch(v1LinesBvh,ivec2(y,0),0);highp vec4 C=texelFetch(v1LinesBvh,ivec2(y+1,0),0);highp vec4 D=texelFetch(v1LinesBvh,ivec2(y+2,0),0);bool E;highp vec2 F;highp vec4 G;highp float H;uint I;highp float J;int K;do{if(floatBitsToInt(B.xy).x==1){highp vec2 L=-i;highp vec2 M=e-C.xy;highp float N=L.x;highp float O=C.w;highp float P=L.y;highp float Q=C.z;highp float R=(N*O)-(P*Q);highp float S=M.x;highp float T=M.y;uint U=floatBitsToUint(R)&2147483648u;highp float V=uintBitsToFloat(floatBitsToUint((S*P)-(T*N))^U);highp float W=uintBitsToFloat(floatBitsToUint((S*O)-(T*Q))^U);bool X=min(V,W)>0.;bool Y;if(X){Y=max(V,W)<abs(R);}else{Y=X;}highp vec2 Z;highp float a_;uint b_;if(Y){highp vec2 c_=i*(W/abs(R));b_=floatBitsToUint(B.y);a_=dot(c_,c_);Z=c_;}else{b_=k;a_=z;Z=i;}bvec4 d_=bvec4(Y);K=m.x;J=l.x;I=b_;H=a_;G=vec4(d_.x?C.x:j.x,d_.y?C.y:j.y,d_.z?C.z:j.z,d_.w?C.w:j.w);F=Z;E=false;break;}highp vec2 e_=(vec2(C.xz)-e.xx)*h.x;highp vec2 f_=(vec2(C.yw)-e.yy)*h.y;highp vec2 g_;if(e_.x>e_.y){g_=e_.yx;}else{g_=e_;}highp vec2 h_;if(f_.x>f_.y){h_=f_.yx;}else{h_=f_;}highp float i_=max(0.,max(g_.x,h_.x));bool j_=i_<min(g_.y,h_.y);bool k_;if(j_){k_=(i_*i_)<z;}else{k_=j_;}if(k_){K=floatBitsToInt(B.y);J=i_;I=k;H=z;G=j;F=i;E=true;break;}K=m.x;J=l.x;I=k;H=z;G=j;F=i;E=false;break;}while(false);highp vec2 l_=c;l_.x=J;ivec2 m_=d;m_.x=K;bool n_;highp float o_;int p_;do{if(floatBitsToInt(B.zw).x==1){highp vec2 q_=-F;highp vec2 r_=e-D.xy;highp float s_=q_.x;highp float t_=D.w;highp float u_=q_.y;highp float v_=D.z;highp float w_=(s_*t_)-(u_*v_);highp float x_=r_.x;highp float y_=r_.y;uint z_=floatBitsToUint(w_)&2147483648u;highp float A_=uintBitsToFloat(floatBitsToUint((x_*u_)-(y_*s_))^z_);highp float B_=uintBitsToFloat(floatBitsToUint((x_*t_)-(y_*v_))^z_);bool C_=min(A_,B_)>0.;bool D_;if(C_){D_=max(A_,B_)<abs(w_);}else{D_=C_;}highp vec2 E_;highp float F_;uint G_;if(D_){highp vec2 H_=F*(B_/abs(w_));G_=floatBitsToUint(B.w);F_=dot(H_,H_);E_=H_;}else{G_=I;F_=H;E_=F;}bvec4 I_=bvec4(D_);p_=m.y;o_=l.y;r=G_;q=F_;p=vec4(I_.x?D.x:G.x,I_.y?D.y:G.y,I_.z?D.z:G.z,I_.w?D.w:G.w);o=E_;n_=false;break;}highp vec2 J_=(vec2(D.xz)-e.xx)*h.x;highp vec2 K_=(vec2(D.yw)-e.yy)*h.y;highp vec2 L_;if(J_.x>J_.y){L_=J_.yx;}else{L_=J_;}highp vec2 M_;if(K_.x>K_.y){M_=K_.yx;}else{M_=K_;}highp float N_=max(0.,max(L_.x,M_.x));bool O_=N_<min(L_.y,M_.y);bool P_;if(O_){P_=(N_*N_)<H;}else{P_=O_;}if(P_){p_=floatBitsToInt(B.w);o_=N_;r=I;q=H;p=G;o=F;n_=true;break;}p_=m.y;o_=l.y;r=I;q=H;p=G;o=F;n_=false;break;}while(false);highp vec2 Q_=l_;Q_.y=o_;ivec2 R_=m_;R_.y=p_;if(E&&n_){ivec2 S_;highp vec2 T_;if(J<o_){T_=Q_.yx;S_=R_.yx;}else{T_=Q_;S_=R_;}int U_=A+1;n[U_]=S_.x;w=U_;v=S_;u=T_;t=S_.y;s=x;}else{bool V_;int W_;int X_;if(E){X_=A;W_=K;V_=x;}else{bool Y_;int Z_;int _a;if(n_){_a=A;Z_=p_;Y_=x;}else{bool aa=A>0;int ba;int ca;if(aa){ca=A-1;ba=n[A];}else{ca=A;ba=y;}_a=ca;Z_=ba;Y_=aa?x:true;}X_=_a;W_=Z_;V_=Y_;}w=X_;v=R_;u=Q_;t=W_;s=V_;}}highp vec2 da;highp float ea;if(k!=4294967295u){highp vec2 fa=normalize(vec2(j.w,-j.z));uint ga=floatBitsToUint(dot(fa,j.xy-e));uint ha=ga&2147483648u;highp vec2 ia=c;ia.x=uintBitsToFloat(floatBitsToUint(fa.x)^ha);highp vec2 ja=ia;ja.y=uintBitsToFloat(floatBitsToUint(fa.y)^ha);ea=uintBitsToFloat(ga^ha);da=ja;}else{ea=1.;da=g;}outPlane=vec4((da*.5)+vec2(.5),ea,1.);}